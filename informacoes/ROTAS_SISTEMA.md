# üìã Documenta√ß√£o de Rotas - Sistema Financeiro Selleta

## üéØ **#memorize**: Sempre atualizar esta documenta√ß√£o quando implementar novas rotas/funcionalidades

---

## üîê **AUTENTICA√á√ÉO**

### `/` (GET)
- **Descri√ß√£o**: P√°gina inicial de login
- **Template**: `login.html`
- **Funcionalidade**: Formul√°rio de autentica√ß√£o de usu√°rios
- **Status**: ‚úÖ Implementado

### `/login` (POST)
- **Descri√ß√£o**: Processa autentica√ß√£o do usu√°rio
- **Par√¢metros**: `username`, `password`
- **Redirecionamento**: `/dashboard` (sucesso) ou `/` (falha)
- **Status**: ‚úÖ Implementado

### `/cadastro` (GET/POST)
- **Descri√ß√£o**: Cadastro de novos usu√°rios
- **Template**: `cadastro.html`
- **Funcionalidade**: Cria√ß√£o de conta com valida√ß√£o de senha
- **Status**: ‚úÖ Implementado

### `/logout` (POST)
- **Descri√ß√£o**: Encerra sess√£o do usu√°rio
- **Redirecionamento**: `/`
- **Status**: ‚úÖ Implementado

---

## üè† **DASHBOARD PRINCIPAL**

### `/dashboard` (GET)
- **Descri√ß√£o**: Painel principal do sistema
- **Template**: `dashboard_novo.html`
- **CSS**: `dashboard_novo.css`
- **Conceito Visual**: 
  - Header azul Selleta com logo e busca
  - Sidebar com navega√ß√£o hier√°rquica
  - KPI cards com m√©tricas
  - Gr√°ficos de receitas/despesas
  - Feed de atividades recentes
- **Status**: ‚úÖ Implementado
- **Autentica√ß√£o**: Obrigat√≥ria

---

## üìÅ **M√ìDULO: CADASTROS**

### üóÇÔ∏è **Plano Financeiro**

#### `/plano_financeiro` (GET)
- **Descri√ß√£o**: Gest√£o hier√°rquica de planos financeiros (4 n√≠veis)
- **Template**: `plano_financeiro.html`
- **CSS**: `plano_financeiro_novo.css`
- **JavaScript**: `plano_financeiro_novo.js`
- **Conceito Visual**:
  - Layout dividido: √°rvore hier√°rquica + formul√°rio
  - Expans√£o progressiva (n√≠veis 1-2 iniciais)
  - Design clean/minimalist
  - Cores Selleta com badges de status
- **Status**: ‚úÖ Implementado e refinado
- **Autentica√ß√£o**: Obrigat√≥ria

#### **API Sub-rotas:**
- `GET /api/planos_financeiros` - Listar todos os planos
- `POST /api/planos_financeiros` - Criar novo plano
- `PUT /api/planos_financeiros/<id>` - Atualizar plano existente

### üè¢ **Empresas**

#### `/empresas` (GET)
- **Descri√ß√£o**: Gest√£o de empresas do Grupo Selleta
- **Template**: `empresas.html`
- **CSS**: `empresas.css`
- **JavaScript**: `empresas.js`
- **Conceito Visual**:
  - Cards responsivos em grid
  - Filtros por munic√≠pio e status
  - Busca em tempo real
  - Bot√µes de a√ß√£o: Relat√≥rio (verde) + Editar (azul)
  - Modal para CRUD com formata√ß√£o autom√°tica
- **Dados**: 7 empresas extra√≠das do Sienge
- **Filtro Padr√£o**: Empresas ativas
- **Status**: ‚úÖ Implementado e refinado
- **Autentica√ß√£o**: Obrigat√≥ria

#### **API Sub-rotas:**
- `GET /api/empresas` - Listar todas as empresas
- `POST /api/empresas` - Criar nova empresa
- `PUT /api/empresas/<id>` - Atualizar empresa existente

#### **Distribui√ß√£o Geogr√°fica:**
- **Cuiab√°**: 4 empresas (sede)
- **Pontes e Lacerda**: 2 empresas
- **Tapurah**: 1 empresa

### üèóÔ∏è **Centro de Custo**

#### `/centro_custo` (GET)
- **Descri√ß√£o**: Gest√£o avan√ßada de centros de custo com sistema de m√°scaras
- **Template**: `centro_custo.html`
- **CSS**: `centro_custo.css`
- **JavaScript**: `centro_custo.js`
- **Conceito Visual**:
  - Interface multi-visualiza√ß√£o: Cards, Tabela, Estat√≠sticas
  - KPI dashboard interativo (Nativos/Dependentes/Gen√©ricos/Total)
  - Sistema de filtros avan√ßados por empresa, tipologia, categoria
  - Sistema de relat√≥rios (6 tipos diferentes)
  - Dual naming: m√°scara_cc (UI) + centro_custo_original (BD)
- **Dados**: 132 centros √∫nicos extra√≠dos e categorizados
- **Categorias**: Nativo (propriet√°rio), Dependente (usa de outra), Gen√©rico (uso comum)
- **Tipologias**: Obra Empreendimento, Obra Privada, Administrativo
- **Status**: ‚úÖ Implementado e refinado
- **Autentica√ß√£o**: Obrigat√≥ria

#### **API Sub-rotas:**
- `GET /api/centros_custo` - Listar centros com JOIN empresas
- `POST /api/centros_custo` - Criar novo centro
- `PUT /api/centros_custo/<id>` - Atualizar centro existente

#### **Sistema de M√°scaras (#memorize):**
- **mascara_cc**: Nome limpo para interface do usu√°rio
- **centro_custo_original**: Nome espec√≠fico para mesclagem com BD anterior
- **L√≥gica**: Interface usa m√°scara, backend usa original para associa√ß√£o de transa√ß√µes

---

## üë• **M√ìDULO: PESSOAS**

### ü§ù **Clientes/Fornecedores** ‚úÖ **IMPLEMENTADO COMPLETO**

#### **Sistema de Detec√ß√£o Inteligente:**
- **2.083 fornecedores √∫nicos** migrados para banco
- **Sistema Fuzzy Matching**: Detec√ß√£o autom√°tica com 44.1% de precis√£o
- **Detec√ß√£o For√ßada**: 646 empresas declaradas automaticamente
- **Corre√ß√µes Aplicadas**: Matches perdidos recuperados (RAFAEL RIZZ, JOAO BARBOZ)
- **100% de Cobertura**: Todos fornecedores categorizados
- **Flags de Auditoria**: `deteccao_forcada` e `deteccao_corrigida`

#### `/clientes_fornecedores` (GET) ‚Üí redireciona para `/fornecedores`
- **Descri√ß√£o**: Gest√£o completa de fornecedores com sistema de detec√ß√£o
- **Template**: `fornecedores.html`
- **CSS**: Integrado com paleta Selleta
- **JavaScript**: `fornecedores.js`
- **Conceito Visual**:
  - Dashboard KPI interativo (6 m√©tricas principais)
  - Dual view: Cards responsivos + Tabela detalhada
  - Filtros avan√ßados: M√©todo, Tipo, Flags especiais
  - Sistema de badges coloridos por tipo de detec√ß√£o
  - CRUD completo com valida√ß√µes
  - Exporta√ß√£o CSV
- **Status**: ‚úÖ **Implementado e ativo**
- **Autentica√ß√£o**: Obrigat√≥ria

#### **API Sub-rotas:**
- `GET /api/fornecedores` - Listar fornecedores com todos os dados
- `POST /api/fornecedores` - Criar novo fornecedor
- `PUT /api/fornecedores/<id>` - Atualizar fornecedor existente
- `DELETE /api/fornecedores/<id>` - Exclus√£o l√≥gica (soft delete)

#### **M√©tricas do Sistema:**
- **Sistema Original**: 1.329 fornecedores (R$ 72.8M)
- **Detec√ß√£o For√ßada**: 646 fornecedores (R$ 3.9M)
- **Detec√ß√£o Fuzzy**: 101 fornecedores (R$ 9.1M)
- **Corre√ß√µes**: 2 fornecedores (R$ 308K)
- **Gen√©ricos**: 5 fornecedores (R$ 2.9M)
- **Total Movimentado**: R$ 88.1 milh√µes

---

## üè¶ **M√ìDULO: FINANCEIRO**

### üí≥ **Contas Banc√°rias** ‚ö†Ô∏è CR√çTICO - Debugging em andamento
#### `/conta_bancaria` (GET)
- **Descri√ß√£o**: Interface completa para gest√£o de contas banc√°rias
- **Template**: `conta_bancaria.html`
- **Funcionalidades**:
  - KPI Dashboard (Banc√°rias, Saldo Total Ativas, Bancos, Total)
  - Dual view: Tabela (‚úÖ funcional) + Cards (‚ùå quebrada)
  - Filtros: Banco, Tipo, Empresa, Status
  - CRUD completo com valida√ß√µes
  - Sistema de soft delete
- **Status**: üö® **DEBUGGING CR√çTICO**
  - ‚úÖ Backend/API funcionando
  - ‚úÖ Tabela view operacional  
  - ‚ùå Cards view n√£o renderiza
  - ‚ùå Filtro padr√£o "Ativa" perdido
- **Autentica√ß√£o**: Obrigat√≥ria

#### **API Sub-rotas:**
- `GET /api/contas_bancarias` - Listar contas banc√°rias
- `POST /api/contas_bancarias` - Criar nova conta
- `PUT /api/contas_bancarias/<id>` - Atualizar conta existente
- `DELETE /api/contas_bancarias/<id>` - Exclus√£o l√≥gica
- `GET /api/bancos` - Listar bancos √∫nicos

#### **Dados do Sistema:**
- **Total Contas**: 55 (27 com banco, 28 ex-TRAVADO=NULL)
- **Contas Ativas**: 2 (150264-6: +R$ 1.000, 47115-2: -R$ 5.400)
- **Saldo Total Ativas**: -R$ 4.400,00 (exibe em vermelho)
- **Bancos √önicos**: 4 institui√ß√µes

---

## üí∞ **M√ìDULO: MOVIMENTA√á√ÉO**

### üìù **Transa√ß√µes** ‚ö†Ô∏è Em desenvolvimento
#### `/nova_transacao` (GET)
- **Status**: üöß Placeholder - redireciona para dashboard
- **Conceito Futuro**: Formul√°rio multi-etapas com parcelas

#### `/transacoes` (GET)
- **Status**: üöß Placeholder - redireciona para dashboard
- **Conceito Futuro**: Listagem com filtros avan√ßados

### üí∏ **Contas a Pagar** ‚ö†Ô∏è Em desenvolvimento
#### `/contas_pagar` (GET)
- **Status**: üöß Placeholder - redireciona para dashboard
- **Conceito Futuro**: Gest√£o de obriga√ß√µes financeiras

### üíµ **Contas a Receber** ‚ö†Ô∏è Em desenvolvimento
#### `/contas_receber` (GET)
- **Status**: üöß Placeholder - redireciona para dashboard
- **Conceito Futuro**: Gest√£o de recebimentos

---

## üìä **M√ìDULO: RELAT√ìRIOS**

### üìà **Relat√≥rios Gerenciais** ‚ö†Ô∏è Em desenvolvimento
#### `/relatorios` (GET)
- **Status**: üöß Placeholder - redireciona para dashboard
- **Conceito Futuro**: Dashboards anal√≠ticos e exporta√ß√£o

---

## ‚öôÔ∏è **M√ìDULO: ADMINISTRA√á√ÉO**

### üë®‚Äçüíº **Gest√£o de Usu√°rios**
#### `/gestao_usuarios` (GET)
- **Descri√ß√£o**: Administra√ß√£o de usu√°rios do sistema
- **Template**: `gestao_usuarios.html`
- **Funcionalidade**: Listar, excluir usu√°rios
- **Status**: ‚úÖ Implementado
- **Autentica√ß√£o**: Obrigat√≥ria

#### `/excluir_usuario/<id>` (POST)
- **Descri√ß√£o**: Exclus√£o de usu√°rio espec√≠fico
- **Redirecionamento**: `/gestao_usuarios` ou `/` (auto-exclus√£o)

---

## üé® **CONCEITO VISUAL GERAL**

### **Paleta de Cores Selleta:**
```css
--selleta-primary: #1976D2;        /* Azul principal */
--selleta-primary-dark: #0D47A1;   /* Azul escuro */
--selleta-primary-light: #42A5F5;  /* Azul claro */
--selleta-white: #FFFFFF;          /* Branco */
--selleta-off-white: #F8F9FA;      /* Branco suave */
--selleta-gray: #666666;           /* Cinza m√©dio */
--selleta-light-gray: #E0E0E0;     /* Cinza claro */
--selleta-dark: #333333;           /* Texto escuro */
```

### **Padr√µes de Interface:**
- **Header**: Gradiente azul com logo, busca e menu do usu√°rio
- **Sidebar**: Navega√ß√£o hier√°rquica com √≠cones e badges de status
- **Cards**: Border-left colorido, shadow sutil, hover effects
- **Bot√µes**: Border-radius 8px, transitions suaves
- **Modais**: Backdrop blur, border-radius 12px
- **Grid**: Responsive, auto-fit minmax
- **Typography**: Font Poppins, hierarquia clara

### **Estados dos Badges:**
- üü¢ **success/Pronto**: Funcionalidade implementada
- üü° **warning/Em breve**: Em desenvolvimento
- üîµ **info/Ativo**: P√°gina atual

### **Filosofia UX:**
- **Clean/Minimalist**: Interfaces limpas, progressive disclosure
- **Mobile-first**: Design responsivo
- **Feedback visual**: Hover states, loading states
- **Consist√™ncia**: Padr√µes visuais repetidos

---

## üóÉÔ∏è **ESTRUTURA DE BANCO DE DADOS**

### **Tabelas Implementadas:**
- ‚úÖ `usuarios` - Autentica√ß√£o
- ‚úÖ `plano_financeiro` - Hierarquia de planos (4 n√≠veis)
- ‚úÖ `empresas` - Empresas do Grupo Selleta (7 empresas)
- ‚úÖ `centros_custo` - Centros de custo com sistema de m√°scaras (132 registros)
- ‚úÖ `fornecedores` - **NOVO**: 2.083 fornecedores com detec√ß√£o inteligente

### **Tabelas Futuras:**
- üöß `contas_bancarias` - Contas do grupo
- üöß `transacoes` - Movimenta√ß√£o financeira (nova estrutura)
- üöß `status_negociacao` - Status customiz√°veis

---

## üìù **PR√ìXIMAS IMPLEMENTA√á√ïES**

### **Ordem de Prioridade:**
1. ‚úÖ **Centro de Custo** - Implementado (tipologias: ADM, OP, OE)
2. ‚úÖ **Clientes/Fornecedores** - **CONCLU√çDO** com sistema de detec√ß√£o inteligente
3. **Contas Banc√°rias** (integra√ß√£o banc√°ria)
4. **Transa√ß√µes** (sistema de parcelas)
5. **Relat√≥rios** (an√°lises gerenciais)

### **Padr√£o de Implementa√ß√£o:**
1. **Extra√ß√£o**: Scripts para processar CSVs
2. **Backend**: Rotas API + valida√ß√µes
3. **Frontend**: Templates + CSS + JavaScript
4. **Refinamento**: Ajustes UX conforme feedback
5. **Documenta√ß√£o**: Atualizar este arquivo

---

## üîÑ **CHANGELOG**

### **v1.0 - Funcionalidades Base**
- ‚úÖ Sistema de autentica√ß√£o
- ‚úÖ Dashboard principal
- ‚úÖ Plano Financeiro (4 n√≠veis hier√°rquicos)
- ‚úÖ Empresas (7 empresas do Grupo Selleta)
- ‚úÖ Gest√£o de usu√°rios

### **v1.1 - M√≥dulos Avan√ßados**
- ‚úÖ Centro de Custo (132 registros com sistema de m√°scaras)
- ‚úÖ Interface multi-visualiza√ß√£o (Cards/Tabela/Estat√≠sticas)
- ‚úÖ Sistema de categoriza√ß√£o inteligente (Nativo/Dependente/Gen√©rico)
- ‚úÖ Consolida√ß√£o Clientes/Fornecedores (3.682 registros unificados)
- ‚úÖ Sistema de v√≠nculos e correspond√™ncias autom√°ticas

### **v1.2 - Sistema de Fornecedores Inteligente**
- ‚úÖ **Fornecedores com Detec√ß√£o Fuzzy** (2.083 registros √∫nicos)
- ‚úÖ **Sistema de Matching Autom√°tico** (44.1% de precis√£o)
- ‚úÖ **Detec√ß√£o For√ßada** (646 empresas declaradas)
- ‚úÖ **Corre√ß√µes Aplicadas** (RAFAEL RIZZ, JOAO BARBOZ recuperados)
- ‚úÖ **CRUD Completo** com interface dual (Cards/Tabela)
- ‚úÖ **KPI Dashboard** (6 m√©tricas de detec√ß√£o)
- ‚úÖ **Flags de Auditoria** para rastreamento
- ‚úÖ **100% de Cobertura** via categorias gen√©ricas

### **Refinamentos Aplicados:**
- ‚úÖ Plano Financeiro: Progressive disclosure (n√≠veis 1-2 iniciais)
- ‚úÖ Empresas: Filtro padr√£o ativas, bot√£o Relat√≥rio, corre√ß√£o "Cuiab√°"
- ‚úÖ Centro de Custo: KPI dashboard, filtros avan√ßados, 6 tipos de relat√≥rios
- ‚úÖ **Fornecedores**: Sistema de detec√ß√£o inteligente + CRUD completo

---

**üìå √öltima atualiza√ß√£o**: 2025-06-25
**üìå Respons√°vel**: Sistema Financeiro Selleta
**üìå Vers√£o**: 1.2 - Sistema de Fornecedores Inteligente